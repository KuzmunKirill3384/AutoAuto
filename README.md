# ๐ค 4โWheel Robot: ะพั ัััะฝะพะณะพ ัะฟัะฐะฒะปะตะฝะธั ะดะพ ะฐะฒัะพะฝะพะผะธะธ


> **ะะพัะพัะบะพ:** ััะพั ัะตะฟะพะทะธัะพัะธะน ัะพะฑะธัะฐะตั ะฒะพะตะดะธะฝะพ **ััะธ** ัะบัะธะฟัะฐ, ะบะพัะพััะต ะฟัะตะฒัะฐัะฐัั ะพะฑััะฝะพะต ัะฐััะธ 4ร4 ะฝะฐ RaspberryยPi ะฒ ะผะฐะปะตะฝัะบะพะณะพ ะพะฑััะฐะตะผะพะณะพ ัะพะฑะพัะฐ.
>
> 1. `main.py`ยโ ัััะฝะพะน ัะตะถะธะผ ัยะณะตะนะผะฟะฐะดะพะผ ะธยะฐะฒัะพะผะฐัะธัะตัะบะธะผ ะปะพะณะธัะพะฒะฐะฝะธะตะผ ะธะทะพะฑัะฐะถะตะฝะธะน;
> 2. `train_robot_model.py`ยโ ะพะฑััะตะฝะธะต MobileNetV3โSmall ะบะปะฐััะธัะธะบะฐัะพัะฐ ะดะตะนััะฒะธะน;
> 3. `run_robot_model.py`ยโ ะฐะฒัะพะฝะพะผะฝะพะต ัะปะตะดะพะฒะฐะฝะธะต ะผะพะดะตะปะธ ะฝะฐ ะฑะพััั Pi.


---

## ๐ ะกะพะดะตัะถะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

| ะคะฐะนะป/ะดะธัะตะบัะพัะธั        | ะงัะพ ะฒะฝัััะธ                                | ะะฐัะตะผ ะฝัะถะฝะพ                                                                  |
| ---------------------- | ----------------------------------------- | ---------------------------------------------------------------------------- |
| `main.py`              | ะะถะพะนััะธะบยโยัะพะฑะพั; ะดะตะปะฐะตั **ัะพัะพโะดะฐัะฐัะตั** | ะกะพะฑะธัะฐะตะผ ะฟัะธะผะตัั ัััั ะดะตะนััะฒะธะน *(`forward`, `rotate_left`, `rotate_right`)*  |
| `train_robot_model.py` | PyTorchโัะบัะธะฟั ะดะปั Desktop/GPU            | ะะฑััะตะฝะธะต CNN + ัะบัะฟะพัั `robot_action_cnn.pth` ะธโฏ`robot_action_cnn_script.pt` |
| `run_robot_model.py`   | ะะฝัะตัะตะฝั ะฝะฐยRaspberryยPi 4ย/ยPiยZeroย2ยW  | ะะตะปะฐะตั ะฟัะตะดัะบะฐะทะฐะฝะธะต > ะทะฐะดะฐัั ะจะะ ะฝะพะณะฐะผ                                       |
| `dataset/`             | JPEGโัะฐะนะปั ะฒะธะดะฐ `forward_001.jpg`โฆ        | ะกัััะต ะดะฐะฝะฝัะต ะดะปั ะพะฑััะตะฝะธั                                                    |
| `models/`              | ะะพัะพะฒัะต ะฒะตัะฐ ัะตัะธ (ะณะตะฝะตัะธััะตััั)          | ะะตััััั `run_robot_model.py`                                                 |

*(ะขะฐะฑะปะธัะฐ ะผะธะฝะธะผะฐะปัะฝะฐ โ ัะพะปัะบะพ ััะพะฑั ะฑััััะพ ัะพัะธะตะฝัะธัะพะฒะฐัััั.)*

---

## ๐๏ธ ะะฟะฟะฐัะฐัะฝัะต ััะตะฑะพะฒะฐะฝะธั

* **ะจะฐััะธ:** ะปัะฑะพะต 4โะบะพะปััะฝะพะต ัยะดะฒัะผั ะโะผะพััะฐะผะธ (L298N) ะธยะจะะโะฟะธะฝะฐะผะธ.
* **ะะดะฝะพะฟะปะฐัะฝะธะบ:** RaspberryยPiย4ยB โฌยะธะปะธ PiยZeroย2ยW (โย25โฏFPS ะฒยะธะฝัะตัะตะฝัะต).
* **ะะฐะผะตัะฐ:** Picamera2 ะธะปะธ CSIโัะพะฒะผะตััะธะผะฐั; fallbackยโ USB+OpenCV.
* **ะะตะนะผะฟะฐะด:** ะปัะฑะพะน, ะบะพัะพััะน ะฒะธะดะธั `pygame` (XโBox, DualShock ะธยั.ะด.).

> **GPIOโะฟะธะฝั** ะทะฐัะธัั ะฒยะบะพะดะต (`main.py`, `run_robot_model.py`).
> ะัะปะธ ัยะฒะฐั ะดััะณะฐั ัะฐัะฟะฐะนะบะฐยโ ะฟะพะฟัะฐะฒััะต ะบะพะฝััะฐะฝัั `FL_IN1 โฆ RR_EN`.

---

## ๐พ ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

### ะะฐ RaspberryยPi (ัะฑะพั ะดะฐัะฐัะตัะฐ **ะธ** ะฐะฒัะพะฝะพะผะธั)

```bash
sudo apt update && sudo apt install python3-pip python3-pygame python3-picamera2
pip3 install torch torchvision pillow opencv-python RPi.GPIO tqdm
```

### ะะฐ ัะฐะฑะพัะตะผ ััะพะปะต (ะพะฑััะตะฝะธะต)

```bash
conda create -n robot python=3.10
conda activate robot
pip install torch torchvision pillow tqdm
```

---

## ๐ ะัััััะน ััะฐัั

1. **ะกะพะฑะตัะธัะต ะดะฐัะฐัะตั**

   ```bash
   # ะฝะฐ RaspberryยPi (ะฟัะธััะฐะฒััะต ัะพะฑะพัั ััะฐััั, ะฒะพะทัะผะธัะต ะณะตะนะผะฟะฐะด)
   python3 main.py --out dataset
   # ๐ธ ะกะบัะธะฟั ัะพััะฐะฝัะตั ~15ยะบะฐะดัะพะฒ/ัะตะบ ัะพะปัะบะพ ะบะพะณะดะฐ ะฒั ะถะผััะต ััะธะบะธ
   ```
2. **ะะตัะตะบะธะฝััะต ัะฝะธะผะบะธ** ะฝะฐ PC/Mac ะธ **ะพะฑััะธัะต ะผะพะดะตะปั**

   ```bash
   python3 train_robot_model.py --data ~/Downloads/pi  # ะฟััั ะบ ะฟะฐะฟะบะต ั JPEG
   # โณ ะฟะพะปััะธะผ robot_action_cnn.pth (ะปัััะธะต ะฒะตัะฐ) ะธ robot_action_cnn_script.pt
   ```
3. **ะะฐะณััะทะธัะต ะฒะตัะฐ ะฝะฐ Pi** ะธ ะทะฐะฟัััะธัะต ะฐะฒัะพะฝะพะผะธั

   ```bash
   scp robot_action_cnn.pth pi@raspberrypi.local:~/robot
   ssh pi@raspberrypi.local
   python3 run_robot_model.py
   ```

---

## ๐๏ธ ะะพะด ะบะฐะฟะพัะพะผ

### main.py โ ัััะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต + ะปะพะณะธัะพะฒะฐะฝะธะต

* ะงะธัะฐะตั ะพัะธ ะณะตะนะผะฟะฐะดะฐ ัะตัะตะท `pygame` (ะผะตััะฒัั ะทะพะฝัย0.20).
* ะะตะปะฐะตั 640ร480ยัะฝะธะผะบะธ; CSV ะฝะตยัะพะทะดะฐัั (ัะพะปัะบะพ JPEG).
* ะะฝะพะฟะบะฐ **`X`**ยโ ััะฐัั/ััะพะฟ ะทะฐะฟะธัะธ, **`Start`**ยโ ะฒััะพะด.

### train\_robot\_model.py โ MobileNetV3โSmall

* ะัะณะผะตะฝัะฐัะธั: `RandomHorizontalFlip`, `ColorJitter`, `BottomMask` (30โ45โฏ%).
* ะะณะฝะพัะธััะตั ะบะปะฐััั `stop`, `backward` (ััะผ).
* ะกะพััะฐะฝัะตั ะปัััะธะน ัะตะบโะฟะพะนะฝั ะฟะพยะฒะฐะปะธะดะฐัะธะธ + ัะบัะฟะพััะธััะตั TorchScript.

### run\_robot\_model.py โ ะธะฝัะตัะตะฝั 50โฏFPS

* ะัะตะฟัะพัะตัั ะฝะฐัะปะตะดัะตั `BottomMask` ะธ `Normalize` ะบะฐะบ ะฟัะธ ะพะฑััะตะฝะธะธ.
* ะฃะฟัะฐะฒะปัะตั GPIO: `BASE_SPEEDย=ย30โฏ%`, `FAST_SPEEDย=ย45โฏ%`.
* ะัะตะณะพ ััะธ ะดะตะนััะฒะธั โ ัะฒะตััะฑััััะฐั ะผะพะดะตะปั (โโฏ5โฏms ะฝะฐ Piย4).

---

## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ ะฟะพัะปะต ะฟะตัะฒะพะณะพ ะทะฐะฟััะบะฐ

```
robot/
โโโ dataset/
โยย โโโ forward_0001.jpg
โยย โโโ rotate_left_0042.jpg
โยย โโโ ...
โโโ models/
โยย โโโ robot_action_cnn.pth
โยย โโโ robot_action_cnn_script.pt
โโโ main.py
โโโ train_robot_model.py
โโโ run_robot_model.py
```

---

## โ FAQ

**Q:** ะะพัะตะผั ะฒั ะทะฐัะตะผะฝัะตัะต ะฝะธะถะฝัั ัะฐััั ะบะฐะดัะฐ?
**A:** ะะพะปััะฐ ะธยะฟะพะป ะฟะพะด ัะพะฑะพัะพะผ ะดะฐัั ัะธะปัะฝัะน bias; ะผะฐัะบะฐ ัะปัััะฐะตั ะพะฑะพะฑัะตะฝะธะต.

**Q:** ะฅะพัั ะดะพะฑะฐะฒะธัั ะบะปะฐัั `backward`ยโ ััะพ ะผะตะฝััั?
**A:** ะะพะฑะฐะฒััะต ะผะตัะบั ะฒย`ACTIONS` (ะพะฑะฐ ัะบัะธะฟัะฐ) ะธยะฟะตัะตะพะฑััะธัะต ะผะพะดะตะปั.

**Q:** ะัะถะฝะพ ะปะธ GPU ะฝะฐ Pi?
**A:** ะะตั โ CPU CortexโA72 ัะฟัะฐะฒะปัะตััั;ยGPU ะฝะตยะธัะฟะพะปัะทัะตััั.

---

## โ๏ธ ะะธัะตะฝะทะธั

MIT ยฉ 2025ยโ ะดะตะปะฐะนัะต ัะพัะบ, ัะปัััะฐะนัะต ะธยะฟัะธััะปะฐะนัะต PR!

---

## ๐ ะะปะฐะณะพะดะฐัะฝะพััะธ

* [PyTorch](https://pytorch.org/) ะทะฐ ะฑัััััะน JIT.
* [Picamera2](https://github.com/raspberrypi/picamera2) ะทะฐ ัะดะพะฑะฝัะน API.
* ะกะพะพะฑัะตััะฒะพ DIYโัะพะฑะพัะพะฒ ะทะฐ ะฒะดะพัะฝะพะฒะตะฝะธะต.
